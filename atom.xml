<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lee Blog</title>
  
  <subtitle>Less is more.  enmm... except hair</subtitle>
  <link href="leeblog.icu/atom.xml" rel="self"/>
  
  <link href="leeblog.icu/"/>
  <updated>2020-10-15T14:21:00.444Z</updated>
  <id>leeblog.icu/</id>
  
  <author>
    <name>Lee</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>优秀开源项目之Shift-etl,从此告别无意义加班</title>
    <link href="leeblog.icu/2020/10/10/%E4%BC%98%E7%A7%80%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%B9%8BShift-etl/"/>
    <id>leeblog.icu/2020/10/10/%E4%BC%98%E7%A7%80%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%B9%8BShift-etl/</id>
    <published>2020-10-10T12:21:48.000Z</published>
    <updated>2020-10-15T14:21:00.444Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这是一个简单轻量的ETL(Extract-Transform-Load)工具，简单到您花5到10分钟的时间读完这篇文章便可以了然它的使用方法，如果你有数据接口对接的业务场景，你可以参考它。<br>它会以数据库配置的方式，帮助你实现数据接口对接，减少重复编码的工作量，同时可以随时灵活调整、降低后续业务调整带来的影响。</p><p>它的核心代码只有三页,分别是<a href="https://github.com/Solo8World/shift-etl/blob/master/src/main/java/com/example/api/service/EtlExtractService.java">EtlExtractService</a> (数据抽取类)、<a href="https://github.com/Solo8World/shift-etl/blob/master/src/main/java/com/example/api/service/EtlProcessService.java">EtlProcessService</a> (数据处理类)、<a href="https://github.com/Solo8World/shift-etl/blob/master/src/main/java/com/example/api/service/EtlLoadService.java">EtlLoadService</a> (数据加载类)；</p><p>然后这是它的github地址：<a href="https://github.com/Solo8World/shift-etl">https://github.com/Solo8World/shift-etl</a>  </p><h2 id="运行流程"><a href="#运行流程" class="headerlink" title="运行流程"></a>运行流程</h2><p>数据抽取(Extract) -&gt; 数据处理(Transform) -&gt; 数据加载(Load)</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul><li>java 1.8+</li><li>mysql5.6+</li></ul><h2 id="快速上手"><a href="#快速上手" class="headerlink" title="快速上手"></a>快速上手</h2><p> “以下均为示例，作者很狗的找了个百度文库的接口来作请求”</p><h3 id="一句需求"><a href="#一句需求" class="headerlink" title="一句需求"></a>一句需求</h3><blockquote><p>对接百度文库接口将返回书籍数据存入本地表demo_wenku_book中。  </p></blockquote><p>接口数据结构示例：<br><img src="https://s1.ax1x.com/2020/10/10/0szB8O.png" width="150%"></p><p>目标表表结构<br><img src="https://s1.ax1x.com/2020/10/10/0yDp5D.png" width="150%"> </p><h3 id="三步实现"><a href="#三步实现" class="headerlink" title="三步实现"></a>三步实现</h3><p><strong>1.将接口信息录入etl_source表</strong><br><img src="https://s1.ax1x.com/2020/10/10/06nw4S.png" width="300%">  </p><p>   etl_source表字段意义解释：  </p><p>   <code>source_key</code>：一个数据同步任务的自定义标识，后面调用etl执行同步时会需要传入此标识  </p><p>   <code>source_url</code>：接口全路径，支持https调用  </p><p>   <code>request_method</code>：接口请求方式，‘GET’，‘post’等，不区分大小写   </p><p>   <code>content_type</code>：接口传参类型，支持0:form、1:json、2:urlencoded传参  </p><p>   <code>process_method</code>：接口数据处理方式，支持0:同步处理(同步进入数据处理及加载逻辑),1:异步处理(异步进入数据处理及加载逻辑),2:自定义处理(不进入数据处理及加载逻辑)  </p><p>   <code>remark</code>： 自定义备注</p><p><strong>2.将数据处理规则录入etl_data_process_rule表</strong><br><img src="https://s1.ax1x.com/2020/10/10/06uA58.png" width="150%">    </p><p>   etl_data_process_rule表字段意义解释：  </p><p>   <code>source_key</code>:一个数据同步任务的自定义标识,同我们第一步中自定义的标识  </p><p>   <code>data_key</code>:源数据json结构中字段位置，<code>data.list[].show_doc_id</code> 中，<code>[]</code>标识为数组  </p><p>   <code>has_mapping</code>:当前示例需求中并不需要，该字段含义是<code>是否需要联查当前数据库中其他字段值来替换</code>，它应用的业务场景如：我们现有一张书籍分类表，源数据结构给了一个书籍分类字段”哲学”，而我们需要转换成分类表对应id并给demo_wenku_book存入。  </p><p>   <code>mapping_id</code>:当前示例需求中并不需要，业务场景同上，该字段用于指定联查操作（etl_data_process_mapping） </p><p>   <code>has_distinct</code>:是否需以此字段进行数据去重 </p><p>   <code>target_table</code>:对应存入表表名，该示例需求下为demo_wenku_book   </p><p>   <code>target_columns</code>:对应存入表字段字段名   </p><p>   <code>default_value</code>:源数据字段值为空时的默认值，无默认值为null</p><p>   <code>exec_sort</code>:该示例需求中并不需要，一个数据同步任务下支持多次数据处理操作，该字段指定了数据处理的执行顺序。业务场景如：先将源数据的书籍分类信息去重存入分类表，再将源数据的书籍信息存入书籍表   </p><p>   <code>exec_type</code>:数据处理后的加载操作类型，支持<code>insert</code>(新增),<code>replace</code>(替换),<code>update</code>(修改),<code>delete</code>(删除),<code>insert or update</code>(根据条件动态新增或修改),<code>java</code>(执行一段java函数)  </p><p>   <code>is_condition</code>:该示例需求中并不需要，该字段的意义是<code>是否为条件字段</code>，条件字段应用于<code>update</code>、<code>delete</code>、<code>insert or update</code>操作类型。  </p><p>   <code>condition_symbol</code>:该示例需求中并不需要，该字段的意义是<code>条件字段的比较符</code>，支持 <code>=``&lt;``&lt;=</code>。当操作类型为<code>java</code>时，该字段用于指明java函数的入参类型(String/Integer)  </p><p>   <code>remark</code>:自定义备注  </p><p><strong>3.调用EtlExtractService.executorClient执行数据同步</strong>  </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">executorClient</span><span class="params">(<span class="meta">@NotNull</span> String sourceKey,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Map&lt;String, Object&gt; param,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Map&lt;String, String&gt; header)</span></span></span><br><span class="line"><span class="function">```  </span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">方法参数:  </span></span><br><span class="line"><span class="function"> `sourceKey`:一个数据同步任务的自定义标识  </span></span><br><span class="line"><span class="function"> `param`:该示例需求中并不需要，接口请求参数，这个其实也可以做成动态自定义而无需硬编码的,看实际需求业务场景  </span></span><br><span class="line"><span class="function"> `header`:该示例需求中并不需要，接口请求头部信息，同上  </span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">所以该示例需求下这么调用一下：  </span></span><br><span class="line"><span class="function">```java </span></span><br><span class="line"><span class="function"> etlExtractService.<span class="title">executorClient</span><span class="params">(<span class="string">&quot;wenku-book&quot;</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 new HashMap&lt;&gt;(<span class="number">0</span>)</span>,new HashMap&lt;&gt;<span class="params">(<span class="number">0</span>)</span>)</span>;</span><br></pre></td></tr></table></figure><p>啊哦，肝到这里出了几个问题：<br>1.项目启动数据库一直连接不上，时区问题驱动版本问题都排查了个遍，最终在application配置文件上找到了原因：我们项目用的yml格式文件，而yml对小数点的解析有问题，而我嫖阿里的rds密码正好就有一个小数点，害，yml改不了俺改。<br>2.demo表忘记加主键自增了，这个倒没花啥时间<br>3.<code>Data too long for column &#39;summary&#39; at row 2</code>，源数据返回的书籍简介超长了，问题不大，加大加长demo表对应字段的长度</p><p>ok继续<br><strong>有了</strong>：<br><img src="https://s1.ax1x.com/2020/10/10/0yRfKg.png" width="150%"><br>(看来大家都有一个发财梦)</p><p>与此同时我们的<code>etl_source_data</code>表中也多了一条数据，嗯是两条：<br><img src="https://s1.ax1x.com/2020/10/10/0yWgoR.png" width="150%"><br>第一条是一条因为数据过长加载失败的记录。第二条最后成功加载的记录。</p><p>   etl_source_data表字段意义解释：<br>   <code>source_key</code>:一个数据同步任务的自定义标识,无需赘述<br>   <code>source_data</code>:同步回来的源数据<br>   <code>processing_status</code>:数据处理/加载状态0-未处理1-处理中,2-处理完成 3-处理失败<br>   <code>action_date</code>:开始处理时间<br>   <code>process_time</code>:处理及加载耗时(毫秒)，我这里网络不好所以耗时较长，正常百毫秒<br>   <code>process_result</code>:处理结果，处理状态失败的话这里会保存错误信息，便于排查  </p><blockquote><p>以上，啰嗦那么多其实操作就简单三步</p></blockquote><hr><h2 id="高（fu）级（za）进（yi）阶（dian）"><a href="#高（fu）级（za）进（yi）阶（dian）" class="headerlink" title="高（fu）级（za）进（yi）阶（dian）"></a>高（fu）级（za）进（yi）阶（dian）</h2><blockquote><p>shift etl能做到的不止如此，更多玩法明天再写，溜了。。。</p></blockquote><p>ps：调用代码俺写在了test目录下,可以搞下来自己试运行.实际业务场景下大多是以定时器定时触发同步任务，而同步任务动态参数逻辑可以在定时任务中实现</p><p>再ps：这个其实是俺自己写的项目，所以这篇bolg的标题那么优秀</p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/10/10/%E4%BC%98%E7%A7%80%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%B9%8BShift-etl/">leeblog.icu/2020/10/10/优秀开源项目之Shift-etl/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">这是一个相对简陋也非常轻量的ETL(Extract-Transform-Load)工具，如果你有数据接口对接的业务场景，你可以参考它。</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    <category term="java" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/java/"/>
    
    
    <category term="java" scheme="leeblog.icu/tags/java/"/>
    
    <category term="开源" scheme="leeblog.icu/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>哲学捡屎之哲学是什么</title>
    <link href="leeblog.icu/2020/10/07/%E5%93%B2%E5%AD%A6%E6%8D%A1%E5%B1%8E%E4%B9%8B%E5%93%B2%E5%AD%A6%E6%98%AF%E4%BB%80%E4%B9%88/"/>
    <id>leeblog.icu/2020/10/07/%E5%93%B2%E5%AD%A6%E6%8D%A1%E5%B1%8E%E4%B9%8B%E5%93%B2%E5%AD%A6%E6%98%AF%E4%BB%80%E4%B9%88/</id>
    <published>2020-10-07T12:37:07.000Z</published>
    <updated>2020-10-10T02:31:36.532Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/10/07/%E5%93%B2%E5%AD%A6%E6%8D%A1%E5%B1%8E%E4%B9%8B%E5%93%B2%E5%AD%A6%E6%98%AF%E4%BB%80%E4%B9%88/">leeblog.icu/2020/10/07/哲学捡屎之哲学是什么/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;本文作者&lt;/strong&gt;：Lee&lt;br/&gt;&lt;strong&gt;本文地址&lt;/strong&gt;： &lt;a href=&quot;leeblog.icu/2020/10/07/%E5%93%B2%E5%AD%A6%E6%8D%A1%E5%B1%8E%E4%B9%8B%E5%93%</summary>
      
    
    
    
    
    <category term="哲学" scheme="leeblog.icu/tags/%E5%93%B2%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>idea插件git commit template的使用与changeLog的生成</title>
    <link href="leeblog.icu/2020/09/13/GIT-Commit-Message%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/"/>
    <id>leeblog.icu/2020/09/13/GIT-Commit-Message%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/</id>
    <published>2020-09-13T11:00:34.000Z</published>
    <updated>2020-10-15T14:16:59.150Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>git commit template 该插件是为了规范git提交注释的。一个项目一个团队的git log一定要整整齐齐的。<br>统一的提交注释规范，除了自己赏心悦目获得极大的舒适感以外，还能为后续的code review、版本升级change log文档的生成，提供极大的便利。  </p><ul><li><strong><a href="https://github.com/angular/angular/blob/master/CONTRIBUTING.md#-commit-message-guidelines">Angular规范</a> 提交格式如下：</strong></li></ul><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">type</span>&gt;</span>(<span class="tag">&lt;<span class="name">scope</span>&gt;</span>): <span class="tag">&lt;<span class="name">subject</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BLANK</span> <span class="attr">LINE</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BLANK</span> <span class="attr">LINE</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p><strong>含义：</strong></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">提交类型(改动涉及范围): 简要描述</span><br><span class="line"><span class="tag">&lt;<span class="name">空行</span>&gt;</span></span><br><span class="line">详细描述(可换多行进行描述)</span><br><span class="line"><span class="tag">&lt;<span class="name">空行</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">页脚</span>&gt;</span>（BREAKING CHANGE重大改动描述；Close Issue）</span><br></pre></td></tr></table></figure></li><li><p><strong>提交类型：</strong></p><ul><li>feat：新功能开发</li><li>fix：bug修复</li><li>docs：项目文档改动</li><li>style： 代码格式（不影响代码运行的变动,空格,格式化,等等）</li><li>refactor：重构（理论上不影响功能的代码重构）</li><li>perf: 性能优化</li><li>test：增加或者修改测试</li><li>build: 影响构建系统或外部依赖项的更改(maven)</li><li>ci: 对CI配置文件和脚本的更改</li><li>chore：对非 src 和 test 目录的修改</li><li>revert: 还原上一次提交</li></ul></li></ul><ul><li><p><strong>以feat提交为例，commit message格式如下:</strong></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="attribute">feat(系统管理)</span>: 新增用户密码设置规则检验  </span><br><span class="line"></span><br><span class="line">(1)验证密码设置由大小写字母数字特殊符号任意三种组合</span><br><span class="line">(2)验证密码设置长度8-12位</span><br></pre></td></tr></table></figure></li><li><p>注：</p><ul><li>提交格式中<code>type</code> 、<code>subject</code>为必填，<code>scope</code>、<code>body</code> 、<code>footer</code>为选填 </li><li>revert提交时以revert:开头, 后面跟着被撤销Commit的Header。<br>Body部分的格式是固定的，必须写成This reverts commit <hash>,<br>其中的hash是被撤销 commit 的 SHA 标识符.</li></ul></li></ul><h2 id="Git-Commit-Template插件的安装与使用"><a href="#Git-Commit-Template插件的安装与使用" class="headerlink" title="Git Commit Template插件的安装与使用"></a><code>Git Commit Template</code>插件的安装与使用</h2><ul><li><strong>安装</strong>  </li></ul><p>idea中直接<code>File</code>-&gt;<code>Setting</code>-&gt;<code>Plugins</code>搜索安装即可<br><img src="https://s1.ax1x.com/2020/09/16/wcTUMQ.png" width="100%"></p><ul><li><strong>使用</strong>  </li></ul><ol><li><p>安装并重启idea后，操作提交时会有此按钮  </p><img src="https://s1.ax1x.com/2020/09/16/wcT2M4.png" width="100%"></li><li><p>点击弹出  </p><img src="https://s1.ax1x.com/2020/09/16/wcTHzD.png" width="100%"></li><li><p>按需填写并确认后生成以下格式：  </p><img src="https://s1.ax1x.com/2020/09/16/wcTjeA.png" width="100%"></li></ol><h2 id="利用conventional-changelog生成Change-log"><a href="#利用conventional-changelog生成Change-log" class="headerlink" title="利用conventional-changelog生成Change log"></a>利用conventional-changelog生成Change log</h2><ul><li><strong>安装</strong><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g conventional-changelog-cli</span><br></pre></td></tr></table></figure></li><li><strong>生成</strong><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conventional-changelog -p angular -i CHANGELOG.md -s</span><br></pre></td></tr></table></figure></li><li><strong>生成的md效果如下</strong>  </li></ul>  <img src="https://s1.ax1x.com/2020/09/16/wc7NY6.png" width="100%"><h2 id="更多可参考"><a href="#更多可参考" class="headerlink" title="更多可参考:"></a>更多可参考:</h2><p><a href="https://www.cnblogs.com/daysme/p/7722474.html">Git 提交的正确姿势：Commit message 编写指南</a><br><a href="https://blog.csdn.net/itguangit/article/details/99590995#t2">IDEA 中 Git Commit message 编写</a><br><a href="http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html">Commit message 和 Change log 编写指南</a>  </p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/09/13/GIT-Commit-Message%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/">leeblog.icu/2020/09/13/GIT-Commit-Message编写规范/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">一个项目一个团队的git log一定要整整齐齐的。统一的提交注释规范，除了自己赏心悦目获得极大的舒适感以外，还能为后续的code review、版本升级change log文档的生成，提供极大的便利。</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="GIT" scheme="leeblog.icu/tags/GIT/"/>
    
    <category term="开发规范" scheme="leeblog.icu/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>GIT Flow流程管理规范</title>
    <link href="leeblog.icu/2020/09/10/GIT-Flow%E6%B5%81%E7%A8%8B%E7%AE%A1%E7%90%86%E8%A7%84%E8%8C%83/"/>
    <id>leeblog.icu/2020/09/10/GIT-Flow%E6%B5%81%E7%A8%8B%E7%AE%A1%E7%90%86%E8%A7%84%E8%8C%83/</id>
    <published>2020-09-10T08:59:33.000Z</published>
    <updated>2020-10-15T14:16:59.143Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a><strong>简介</strong></h2><blockquote><p>Git Flow Integration插件是基于git flow(开发流程管理模型)的idea插件。  </p></blockquote><p>git flow开发流程管理模型主要使用五类分支：  </p><ul><li>master 主分支:生产环境部署分支, master分支永远与生产环境部署的版本保持同步。  </li><li>develop 开发分支:永远是下一个版本中已开发完成的新特性的最新代码。 </li><li>feature/功能名称: 新功能开发分支,为具体某一新功能开发而存在的临时分支,开发完成后合并回develop分支,并删除。 </li><li>release/版本号:预上线分支,版本中所有功能开发完毕并合并到develop以后,从develop开出release分支进行整体测试，测试稳定后打上tag同时并入develop、master分支。  </li><li>hotfix/bug:生产环境bug修复分支,修复后双向合并到develop和master。   </li></ul><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a><strong>安装</strong></h2><ul><li>Git Flow Integration依赖于本地git flow，所以先安装git flow软件包:  <blockquote><p>执行<code>git flow version</code> 检查是否已安装</p></blockquote><ul><li>Ubuntu or Debian安装<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt-get install git-flow </span><br></pre></td></tr></table></figure></li><li>Archlinux 安装<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yaourt -S gitflow-avh </span><br></pre></td></tr></table></figure></li><li>Windows安装<br>请参考 <a href="https://juejin.im/post/6844903682027307022">Windows下gitflow的安装方法</a>  </li></ul></li><li>安装Idea插件<br>idea中<code>File</code>-&gt;<code>Setting</code>-&gt;<code>Plugins</code>搜索安装即可  <img src="https://s1.ax1x.com/2020/09/16/wc7rmd.png" width="100%">  </li></ul><h2 id="插件使用"><a href="#插件使用" class="headerlink" title="插件使用"></a><strong>插件使用</strong></h2><ol><li><p>安装并重启idea后,右下角出现<code>No Gitflow</code>  </p>  <img src="https://s1.ax1x.com/2020/09/16/wc7Imj.png" width="100%"></li><li><p>点击init repo进行初始化<br><em>注：git flow init之前请确保本地没有尚未提交的更改</em>  </p><img src="https://s1.ax1x.com/2020/09/16/wc7jcF.png" width="100%"></li><li><p>确认后git flow自动基于master创建并切换到develop分支，并在右下角gitflow中出现操作选项    </p><img src="https://s1.ax1x.com/2020/09/16/wcHp7R.png" width="100%"> <figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">* </span>新功能开发分支线（feature）</span><br><span class="line"><span class="bullet">* </span>开发版本bug修复线（bugfix）</span><br><span class="line"><span class="bullet">* </span>新版本发布线/预上线（release）</span><br><span class="line"><span class="bullet">* </span>生产版本bug修复线（hotfix）</span><br></pre></td></tr></table></figure></li><li><p>开始使用，开发系统管理模块  </p><img src="https://s1.ax1x.com/2020/09/16/wcHVje.png" width="100%"></li><li><p>确认后自动生成feature为前缀的开发分支，并提供以下操作  </p><img src="https://s1.ax1x.com/2020/09/16/wcHQ4P.jpg" width="70%"></li></ol><p><code>Finish feature</code> 结束分支：合并当前开发分支至develop并删除当前开发分支<br><code>Publish feature</code>推送分支至远程仓库</p><h2 id="扩-分支管理详细"><a href="#扩-分支管理详细" class="headerlink" title="扩:分支管理详细"></a>扩:分支管理详细</h2><ul><li>master<ul><li>主分支, 随项目一直存在的长期分支.</li><li>master分支HEAD所在的位置, 永远是当前生产环境的代码.</li><li>master分支不允许直接提交代码, 仅允许从release或者hotfix分支通过merge request合并代码.</li></ul></li><li>develop<ul><li>开发分支, 随项目一直存在的长期分支.</li><li>develop分支的HEAD所在的位置, 永远是下一个版本中已开发完成的新特性的最新代码.</li><li>develop分支的代码每天自动构建并部署到测试环境.</li><li>develop分支不允许直接提交代码, 仅允许从feature, release或者hotfix分支通过merge request合并代码.</li><li>当develop分支中下一个版本的新特性已经全部开发完毕后, 从develop分支开出release分支, 进入测试阶段.</li><li>在下个版本的release分支创建之前, 非下个版本的feature分支不允许向develop分支合并.</li></ul></li><li>feature分支<ul><li>feature分支是一类以feature/为前缀(gitflow默认值, 可以更换)的分支的统称.</li><li>每一个feature分支从develop分支新建, 进行<strong>某一个功能</strong>的开发. 功能开发并测试稳定后, feature分支将合并回develop分支.</li><li>同一个人可以同时开发多个feature分支, 同一个feature分支也可以同时被多个人开发.</li><li>多个feature同时开发的情形, 后开发完的分支在最后合并回develop时, 往往会遇到冲突的情况. 此时一般遵循一下两种方法解决冲突.<ul><li>先将最新的develop分支向当前feature分支进行合并, 然后再将当前feature分支合并回develop.</li><li>先将当前的feature分支向最新的develop分支进行rebase, 然后再将当前feature分支合并回develop.</li><li>两种方式的比较, 可以参考文章Merging vs. Rebasing, 或其中文版代码合并：Merge、Rebase 的选择</li></ul></li></ul></li><li>release分支<ul><li>release分支是一类以release/为前缀(gitflow默认值, 可以更换)的分支的统称.</li><li>develop分支上的下一个版本的所有新特性开发完毕, 从develop分支开出一个该版本的release分支, 并进行测试.</li><li>release分支不允许进行新特性开发, 而只进行bug修复和更新版本mata信息(如版本号, 构建日期, 更新日志等), 并且可以不定期将新的bug修复改动合并回develop.</li><li>当release充分测试稳定后, 同时合并进入master分支和develop分支, 并在master分支上的建议该release版本的TAG.</li></ul></li><li>hotfix分支<ul><li>当生产环境发现紧急bug时，可以通过新建hotfix分支，来修复bug, 修复后双向合并到develop和master.  </li></ul></li></ul><h2 id="更多可参考"><a href="#更多可参考" class="headerlink" title="更多可参考:"></a>更多可参考:</h2><p><a href="https://www.git-tower.com/learn/git/ebook/cn/command-line/advanced-topics/git-flow">git-flow 的工作流程| Learn Version Control with Git</a><br><a href="http://www.ruanyifeng.com/blog/2015/12/git-workflow.html">Git 工作流程- 阮一峰的网络日志</a><br><a href="https://zhuanlan.zhihu.com/p/153459671">git flow使用规范</a></p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/09/10/GIT-Flow%E6%B5%81%E7%A8%8B%E7%AE%A1%E7%90%86%E8%A7%84%E8%8C%83/">leeblog.icu/2020/09/10/GIT-Flow流程管理规范/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">Git Flow Integration插件是基于git flow(开发流程管理模型)的idea插件。</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="GIT" scheme="leeblog.icu/tags/GIT/"/>
    
    <category term="开发规范" scheme="leeblog.icu/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>Markdown语法与Pandoc转换</title>
    <link href="leeblog.icu/2020/09/08/Markdown%E8%AF%AD%E6%B3%95%E4%B8%8EPandoc%E8%BD%AC%E6%8D%A2/"/>
    <id>leeblog.icu/2020/09/08/Markdown%E8%AF%AD%E6%B3%95%E4%B8%8EPandoc%E8%BD%AC%E6%8D%A2/</id>
    <published>2020-09-08T09:02:59.000Z</published>
    <updated>2020-11-12T05:34:51.502Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>前言： markdown极简主义标记语言，能帮我们进行便捷的文字排版，文档写作居家必备。<br>语法比较简单，本文不再作过多赘述。重点是pandoc，pandoc是约翰麦克法兰（一位伯克利哲学系的教授）开发的一个文本转换工具，<br>能帮我们将md文件转换为word、pdf、html，甚至ppt，当然，不止如此，你能想到的它都可以做到，号称文档转换界的瑞士军刀。</p></blockquote><h1 id="文本标记语言-Markdown"><a href="#文本标记语言-Markdown" class="headerlink" title="文本标记语言 Markdown"></a>文本标记语言 <code>Markdown</code></h1><blockquote><p>最流行的轻量<a href="https://baike.baidu.com/item/%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80/5964436?fr=aladdin">文本标记语言</a></p></blockquote><h2 id="常用语法："><a href="#常用语法：" class="headerlink" title="常用语法："></a>常用语法：</h2><img src="https://s1.ax1x.com/2020/09/16/wcHHDH.png" width="100%"><h2 id="更多请参考"><a href="#更多请参考" class="headerlink" title="更多请参考"></a>更多请参考</h2><p><a href="https://www.runoob.com/markdown/md-tutorial.html">Markdown 教程| 菜鸟教程</a></p><hr><h1 id="标记语言转换工具Pandoc"><a href="#标记语言转换工具Pandoc" class="headerlink" title="标记语言转换工具Pandoc"></a>标记语言转换工具<code>Pandoc</code></h1><ul><li><p><strong>简介</strong> </p><blockquote><p><a href="https://pandoc.org/">Pandoc</a> 是由<a href="https://johnmacfarlane.net/macfarlane-cv.html">John MacFarlane</a> 开发的标记语言转换工具，可实现不同标记语言间的格式转换，堪称该领域中的“瑞士军刀”。  </p></blockquote><img src="https://s1.ax1x.com/2020/09/16/wcbFVs.jpg" width="10%"> </li></ul><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a><strong>安装</strong></h2><ul><li>点击进入二进制包<a href="https://github.com/jgm/pandoc/releases/tag/2.10.1">下载页面</a> 选取对应包下载安装即可  </li></ul><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a><strong>使用</strong></h2><ul><li><p>markdown转word  </p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">pandoc</span> <span class="selector-tag">git-extend</span><span class="selector-class">.md</span>  <span class="selector-tag">-o</span> <span class="selector-tag">md_convert_doc</span><span class="selector-class">.docx</span></span><br></pre></td></tr></table></figure></li><li><p>markdown转html</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">pandoc</span> <span class="selector-tag">git-extend</span><span class="selector-class">.md</span>  <span class="selector-tag">-o</span> <span class="selector-tag">md_convert_html</span><span class="selector-class">.html</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/09/08/Markdown%E8%AF%AD%E6%B3%95%E4%B8%8EPandoc%E8%BD%AC%E6%8D%A2/">leeblog.icu/2020/09/08/Markdown语法与Pandoc转换/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">markdown极简主义标记语言，能帮我们进行便捷的文字排版，文档写作居家必备。pandoc是约翰麦克法兰（一位伯克利哲学系的教授）开发的一个文本转换工具</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="文档" scheme="leeblog.icu/tags/%E6%96%87%E6%A1%A3/"/>
    
  </entry>
  
  <entry>
    <title>Maven插件之git-commit-id</title>
    <link href="leeblog.icu/2020/09/05/Maven%E6%8F%92%E4%BB%B6%E4%B9%8Bgit-commit-id/"/>
    <id>leeblog.icu/2020/09/05/Maven%E6%8F%92%E4%BB%B6%E4%B9%8Bgit-commit-id/</id>
    <published>2020-09-05T09:00:58.000Z</published>
    <updated>2020-10-15T14:24:34.167Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Maven插件-git-commit-id-plugin"><a href="#Maven插件-git-commit-id-plugin" class="headerlink" title="Maven插件 git-commit-id-plugin"></a>Maven插件 <code>git-commit-id-plugin</code></h1><blockquote><p>让我们通过接口就晓得后台代码的版本。    </p></blockquote><p>该插件会在源码编译打包时生成git版本信息、打包信息，便于后期运维。</p><h2 id="git-commit-id-plugin-使用"><a href="#git-commit-id-plugin-使用" class="headerlink" title="git-commit-id-plugin 使用"></a><a href="https://github.com/git-commit-id/git-commit-id-maven-plugin">git-commit-id-plugin</a> 使用</h2><ul><li><p>pom文件引入</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>pl.project13.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>git-commit-id-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">generateGitPropertiesFile</span>&gt;</span>true<span class="tag">&lt;/<span class="name">generateGitPropertiesFile</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">injectAllReactorProjects</span>&gt;</span>true<span class="tag">&lt;/<span class="name">injectAllReactorProjects</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>重新打包，jar包中自动生成<code>git.properties</code>文件，如下：  </p><img src="https://s1.ax1x.com/2020/09/16/wcHBCV.png" width="100%"></li><li><p>编写项目版本信息查询接口</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> GitProperties gitProperties;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/version&quot;)</span></span><br><span class="line"><span class="function">HashMap&lt;String, String&gt; <span class="title">version</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HashMap&lt;String, String&gt; versionInfo = <span class="keyword">new</span> HashMap&lt;&gt;(<span class="number">8</span>);</span><br><span class="line">    versionInfo.put(<span class="string">&quot;branch&quot;</span>, gitProperties.getBranch());</span><br><span class="line">    versionInfo.put(<span class="string">&quot;commitId&quot;</span>, gitProperties.getCommitId());</span><br><span class="line">    versionInfo.put(<span class="string">&quot;commitMessage&quot;</span>, gitProperties.get(<span class="string">&quot;commit.message.full&quot;</span>));</span><br><span class="line">    versionInfo.put(<span class="string">&quot;commitUser&quot;</span>, gitProperties.get(<span class="string">&quot;commit.user.name&quot;</span>));</span><br><span class="line">    versionInfo.put(<span class="string">&quot;commitTime&quot;</span>, DateUtil.date(Long.parseLong(gitProperties.get(<span class="string">&quot;commit.time&quot;</span>))).toString());</span><br><span class="line">    versionInfo.put(<span class="string">&quot;buildHost&quot;</span>, gitProperties.get(<span class="string">&quot;build.host&quot;</span>));</span><br><span class="line">    versionInfo.put(<span class="string">&quot;buildUser&quot;</span>, gitProperties.get(<span class="string">&quot;build.user.name&quot;</span>));</span><br><span class="line">    versionInfo.put(<span class="string">&quot;buildTime&quot;</span>, DateUtil.date(Long.parseLong(gitProperties.get(<span class="string">&quot;build.time&quot;</span>))).toString());</span><br><span class="line">    <span class="keyword">return</span>  versionInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>请求接口  </p><img src="https://s1.ax1x.com/2020/09/16/wcHRER.png" width="100%"></li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>springBoot 2.3.0之后的版本无法直接注入GitProperties，<br>需要在启动类声明GitProperties类的Bean属性。</li></ul><h2 id="更多请参考"><a href="#更多请参考" class="headerlink" title="更多请参考"></a>更多请参考</h2><p><a href="https://github.com/git-commit-id/git-commit-id-maven-plugin">该插件的github</a></p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/09/05/Maven%E6%8F%92%E4%BB%B6%E4%B9%8Bgit-commit-id/">leeblog.icu/2020/09/05/Maven插件之git-commit-id/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">让我们通过接口就晓得后台代码的版本。该插件会在源码编译打包时生成git版本信息、打包信息，便于后期运维。</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    <category term="java" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/java/"/>
    
    
    <category term="GIT" scheme="leeblog.icu/tags/GIT/"/>
    
  </entry>
  
  <entry>
    <title>Java三页代码之——实现Mysql透明加解密</title>
    <link href="leeblog.icu/2020/08/16/Java%E4%B8%89%E9%A1%B5%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%AE%9E%E7%8E%B0Mysql%E9%80%8F%E6%98%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/"/>
    <id>leeblog.icu/2020/08/16/Java%E4%B8%89%E9%A1%B5%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%AE%9E%E7%8E%B0Mysql%E9%80%8F%E6%98%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/</id>
    <published>2020-08-16T07:14:18.000Z</published>
    <updated>2020-10-08T01:39:42.694Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间有项目需求做个简单的数据加密，根据开发成本和程序性能综合考虑，<br>最终选定利用mysql加解密函数进行实现。</p><h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><p>项目sql执行前进行拦截，如果包含加密字段则对sql进行字符串截取拼接处理，<br>不同类型不同处理方式：  </p><ul><li>select类型：select字段拼上解密函数及密钥</li><li>insert类型：insert对应字段值拼上加密函数及密钥</li><li>delete类型：对应字段where条件值拼上加密函数及密钥</li><li>update类型：update对应字段值拼上加密字段及密钥，对应字段where条件值拼上加密函数及密钥</li></ul><h2 id="用到的第三方工具包"><a href="#用到的第三方工具包" class="headerlink" title="用到的第三方工具包"></a>用到的第三方工具包</h2><p><a href="https://hutool.cn/">HuTool</a> (一个小而美的java工具包)  </p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="上代码"><a href="#上代码" class="headerlink" title="上代码"></a>上代码</h2><ul><li><p>配置类</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lee.blog.config.mybatis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lizhuo</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//要加密的字段</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; FIELD = </span><br><span class="line">                  Arrays.asList(<span class="string">&quot;card_no&quot;</span>, <span class="string">&quot;card_key&quot;</span>, <span class="string">&quot;card_private_no&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SALT = <span class="string">&quot;\&quot;bc7a5744-fbf0-5288-c20e-e87ea9ee1ba0\&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ENC_PREFIX = <span class="string">&quot;HEX(ENCODE(&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ENC_SUFFIX = <span class="string">&quot;,&quot;</span> + SALT + <span class="string">&quot;))&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEC_PREFIX = <span class="string">&quot;DECODE(UNHEX(&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEC_SUFFIX = <span class="string">&quot;),&quot;</span> + SALT + <span class="string">&quot;)&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String AS = <span class="string">&quot;AS&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SELECT = <span class="string">&quot;SELECT&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String FROM = <span class="string">&quot;FROM&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>mybatise拦截类</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lee.blog.config.mybatis;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.ReflectUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.StrUtil;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.executor.statement.RoutingStatementHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.executor.statement.StatementHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.BoundSql;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.plugin.*;</span><br><span class="line"><span class="keyword">import</span> org.jetbrains.annotations.NotNull;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicReference;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lizhuo</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Intercepts(&#123;</span></span><br><span class="line"><span class="meta">        @Signature(type = StatementHandler.class, method = &quot;prepare&quot;, args = &#123;Connection.class, Integer.class&#125;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrepareInterceptor</span> <span class="keyword">implements</span> <span class="title">Interceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INSERT = <span class="string">&quot;INSERT&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">plugin</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Plugin.wrap(target, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProperties</span><span class="params">(Properties properties)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (invocation.getTarget() <span class="keyword">instanceof</span> RoutingStatementHandler handler) &#123;</span><br><span class="line">            StatementHandler delegate =</span><br><span class="line">                    (StatementHandler) ReflectUtil.getFieldValue(handler, <span class="string">&quot;delegate&quot;</span>);</span><br><span class="line">            BoundSql boundSql = delegate.getBoundSql();</span><br><span class="line">            <span class="keyword">final</span> String sql = boundSql.getSql();</span><br><span class="line">            <span class="keyword">if</span> (needHandler(sql)) &#123;</span><br><span class="line">                handlerSql(boundSql);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handlerSql</span><span class="params">(BoundSql boundSql)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//String result = SQLUtils.format(boundSql.getSql(), JdbcConstants.MYSQL);</span></span><br><span class="line">        String sql = replaceSql(boundSql.getSql());</span><br><span class="line">        <span class="keyword">switch</span> (sql.substring(<span class="number">0</span>, <span class="number">6</span>).toUpperCase()) &#123;</span><br><span class="line">            <span class="keyword">case</span> EncConfig.SELECT -&gt; sql = handlerQuerySql(sql);</span><br><span class="line">            <span class="keyword">case</span> INSERT -&gt; sql = handlerInsertSql(sql);</span><br><span class="line">            <span class="keyword">default</span> -&gt; sql = handlerDeleteOrUpdateSql(sql);</span><br><span class="line">        &#125;</span><br><span class="line">        ReflectUtil.setFieldValue(boundSql, <span class="string">&quot;sql&quot;</span>, sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">handlerDeleteOrUpdateSql</span><span class="params">(String sql)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Sql(sql).toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">handlerQuerySql</span><span class="params">(String sql)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Sql(sql).toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">handlerInsertSql</span><span class="params">(String sql)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> List&lt;String&gt; insertFiled = Arrays.asList(</span><br><span class="line">                sql.substring(sql.indexOf(<span class="string">&quot;(&quot;</span>) + <span class="number">1</span>, sql.indexOf(<span class="string">&quot;)&quot;</span>)).split(StrUtil.COMMA));</span><br><span class="line">        String insertValueStr = sql.substring(sql.lastIndexOf(<span class="string">&quot;(&quot;</span>) + <span class="number">1</span>, sql.lastIndexOf(<span class="string">&quot;)&quot;</span>));</span><br><span class="line">        List&lt;String&gt; insertValue = <span class="keyword">new</span> ArrayList&lt;&gt;(Arrays.asList(</span><br><span class="line">                insertValueStr.split(StrUtil.COMMA)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; insertFiled.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">final</span> Optional&lt;String&gt; any = EncConfig.FIELD.stream().filter(insertFiled.get(i)::contains).findAny();</span><br><span class="line">            <span class="keyword">if</span> (any.isPresent()) &#123;</span><br><span class="line">                insertValue.set(i, EncConfig.ENC_PREFIX + insertValue.get(i) + EncConfig.ENC_SUFFIX);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> replaceSql(sql, insertValueStr, insertValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">replaceSql</span><span class="params">(String sql, String resourceStr, List&lt;String&gt; targetStrList)</span> </span>&#123;</span><br><span class="line">        AtomicReference&lt;String&gt; targetQueryFiledStr = <span class="keyword">new</span> AtomicReference&lt;&gt;(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        targetStrList.forEach(i -&gt; targetQueryFiledStr.set(</span><br><span class="line">                StringUtils.isBlank(targetQueryFiledStr.get()) ?</span><br><span class="line">                        targetQueryFiledStr + i : targetQueryFiledStr + StrUtil.COMMA + i));</span><br><span class="line">        sql = sql.replace(resourceStr, targetQueryFiledStr.get());</span><br><span class="line">        <span class="keyword">return</span> sql;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">needHandler</span><span class="params">(String sql)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> EncConfig.FIELD.stream().anyMatch(sql::contains);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤特殊字符</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">replaceSql</span><span class="params">(String sql)</span> </span>&#123;</span><br><span class="line">        sql = sql.replaceAll(<span class="string">&quot;\\n&quot;</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">        sql = sql.replaceAll(<span class="string">&quot;\\t&quot;</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sql;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>sql转换类</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lee.blog.config.mybatis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.StrUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span>  com.lee.blog.config.mybatis.EncConfig.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lizhuo</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sql</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String execType;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;QueryField&gt; queryField;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String remainder;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sql</span><span class="params">(String sqlStr)</span> </span>&#123;</span><br><span class="line">        StringBuilder sql = <span class="keyword">new</span> StringBuilder(sqlStr);</span><br><span class="line">        <span class="keyword">this</span>.execType = sql.substring(<span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!SELECT.equalsIgnoreCase(execType)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.remainder = sql.substring(<span class="number">6</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> fromIndex = StringUtils.indexOfIgnoreCase(sql, FROM);</span><br><span class="line">        <span class="comment">//解析并赋值对象</span></span><br><span class="line">        String queryFieldStr = sql.substring(<span class="number">6</span>, fromIndex);</span><br><span class="line">        <span class="keyword">boolean</span> has = EncConfig.FIELD.stream().anyMatch(queryFieldStr::contains);</span><br><span class="line">        <span class="keyword">if</span> (has) &#123;</span><br><span class="line">            List&lt;String&gt; queryField = Arrays.asList(queryFieldStr.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">            List&lt;QueryField&gt; field = <span class="keyword">new</span> ArrayList&lt;&gt;(queryField.size());</span><br><span class="line">            queryField.forEach(i -&gt; field.add(<span class="keyword">new</span> QueryField(i)));</span><br><span class="line">            <span class="keyword">this</span>.queryField = field;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.queryField = Collections.singletonList(<span class="keyword">new</span> QueryField(queryFieldStr));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.remainder = sql.substring(fromIndex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StringBuilder sql = <span class="keyword">new</span> StringBuilder(execType);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isNotEmpty(queryField)) &#123;</span><br><span class="line">            queryField.forEach(i -&gt; sql.append(i.toString()).append(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">            sql.setCharAt(sql.length() - <span class="number">1</span>, <span class="string">&quot; &quot;</span>.charAt(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        EncConfig.FIELD.forEach(i -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (remainder.contains(i + <span class="string">&quot; = ?&quot;</span>)) &#123;</span><br><span class="line">                remainder = remainder.replace(i + <span class="string">&quot; = ?&quot;</span>,</span><br><span class="line">                        i + <span class="string">&quot; = &quot;</span> + EncConfig.ENC_PREFIX + <span class="string">&quot;?&quot;</span> + EncConfig.ENC_SUFFIX);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (remainder.contains(i + <span class="string">&quot; in&quot;</span>) || remainder.contains(i + <span class="string">&quot; not in&quot;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">                String substring = remainder.substring(</span><br><span class="line">                        remainder.indexOf(i + <span class="string">&quot; in (&quot;</span>) + (i + <span class="string">&quot; in (&quot;</span>).length());</span><br><span class="line"></span><br><span class="line">                String valueStr = substring.substring(<span class="number">0</span>, substring.indexOf(<span class="string">&quot;)&quot;</span>));</span><br><span class="line"></span><br><span class="line">                remainder = remainder.replace(valueStr,</span><br><span class="line">                        valueStr.replace(<span class="string">&quot;?&quot;</span>,</span><br><span class="line">                                EncConfig.ENC_PREFIX + <span class="string">&quot;?&quot;</span> + EncConfig.ENC_SUFFIX));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        sql.append(remainder);</span><br><span class="line">        <span class="keyword">return</span> sql.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryField</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String field;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String function;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String alias;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">QueryField</span><span class="params">(String field)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">boolean</span> anyMatch = EncConfig.FIELD.stream().anyMatch(field::contains);</span><br><span class="line">            <span class="keyword">if</span> (!anyMatch) &#123;</span><br><span class="line">                <span class="keyword">this</span>.field = field;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">boolean</span> hasFunction = field.contains(<span class="string">&quot;(&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (hasFunction) &#123;</span><br><span class="line">                <span class="keyword">int</span> lastIndexOfStart = field.lastIndexOf(<span class="string">&quot;(&quot;</span>);</span><br><span class="line">                <span class="keyword">int</span> lastIndexOfEnd = field.lastIndexOf(<span class="string">&quot;)&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.function = field.substring(<span class="number">0</span>, lastIndexOfStart) + <span class="string">&quot;(@function@)&quot;</span></span><br><span class="line">                        + field.substring(lastIndexOfEnd + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                field = field.substring(lastIndexOfStart + <span class="number">1</span>, lastIndexOfEnd);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">boolean</span> hasAlias = StringUtils.containsIgnoreCase(field, AS);</span><br><span class="line">            <span class="keyword">boolean</span> hasPrefix = field.contains(StrUtil.DOT);</span><br><span class="line">            <span class="keyword">if</span> (hasAlias) &#123;</span><br><span class="line">                <span class="keyword">this</span>.alias = field.substring(StringUtils.indexOfIgnoreCase(field, AS) + <span class="number">2</span>);</span><br><span class="line">                field = field.substring(<span class="number">0</span>, StringUtils.indexOfIgnoreCase(field, AS));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.alias = AS + <span class="string">&quot; &quot;</span> + (hasPrefix ?</span><br><span class="line">                        field.substring(field.indexOf(StrUtil.DOT) + <span class="number">1</span>) : field);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.field = field;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">boolean</span> anyMatch = EncConfig.FIELD.stream().anyMatch(field::contains);</span><br><span class="line">            field = anyMatch ? EncConfig.DEC_PREFIX + field + EncConfig.DEC_SUFFIX : field;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> StringUtils.isEmpty(function) ? field + (alias == <span class="keyword">null</span> ? <span class="string">&quot;&quot;</span> : alias)</span><br><span class="line">                    : function.replace(<span class="string">&quot;@function@&quot;</span>, field) + (alias == <span class="keyword">null</span> ? <span class="string">&quot;&quot;</span> : alias);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><em>ps</em> ：</p><ul><li><p>拦截处理并不支持SELECT * 语句,不建议项目中使用SELECT *； </p></li><li><p>项目中如果没有单独mybatis配置类的话，拦截器默认生效，如果包含配置类则需在配置类中指定开启</p></li></ul><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/08/16/Java%E4%B8%89%E9%A1%B5%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%AE%9E%E7%8E%B0Mysql%E9%80%8F%E6%98%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/">leeblog.icu/2020/08/16/Java三页代码之实现Mysql透明加解密/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">前段时间有项目需求做个简单的数据加密，根据开发成本和程序性能综合考虑，最终选定利用mysql加解密函数进行实现。</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    <category term="java" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/java/"/>
    
    
    <category term="java" scheme="leeblog.icu/tags/java/"/>
    
    <category term="x页代码" scheme="leeblog.icu/tags/x%E9%A1%B5%E4%BB%A3%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>Java一页代码之——实现微信自动智能回复</title>
    <link href="leeblog.icu/2020/07/10/Java%E4%B8%80%E9%A1%B5%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E8%87%AA%E5%8A%A8%E5%9B%9E%E5%A4%8D/"/>
    <id>leeblog.icu/2020/07/10/Java%E4%B8%80%E9%A1%B5%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E8%87%AA%E5%8A%A8%E5%9B%9E%E5%A4%8D/</id>
    <published>2020-07-10T07:25:48.000Z</published>
    <updated>2021-05-09T02:43:34.551Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>机器可以替代我们自动打开空调，可以替代我们洗碗拖地，甚至替代我们开车(真开车，别多想)，<br>现在，它还可以替我们聊天，是的，它说：Yes，I do!</p></blockquote><blockquote><p>可喜可贺的是，帮我回复女朋友微信消息的智能程序写好了，女朋友还没有。</p></blockquote><blockquote><p>所以屏幕前好奇这个程序的你，还看什么代码，赶紧滚去找对象。</p></blockquote><blockquote><p>有对象了？那我劝你且行且珍惜。本程序对运行后果概不负责。</p></blockquote><h2 id="正题"><a href="#正题" class="headerlink" title="正题"></a>正题</h2><h3 id="实现效果先看一眼："><a href="#实现效果先看一眼：" class="headerlink" title="实现效果先看一眼："></a>实现效果先看一眼：</h3><p>【这个enmm暂时还没有，因为木有人给俺发消息，害…】 </p><h3 id="实现思路："><a href="#实现思路：" class="headerlink" title="实现思路："></a>实现思路：</h3><ol><li>利用微信网页端接口登陆微信并监听消息</li><li>收到消息后请求图灵智能机器人api接口获得智能回复消息内容</li><li>通过微信接口回复智能消息</li></ol><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><ul><li><p>maven引入包</p><ul><li>wechat-api (来自<a href="https://github.com/biezhi/wechat-api">biezhi的github</a>)<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.biezhi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>wechat-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><a href="https://hutool.cn/">HuTool</a> (一个小而美的java工具包)<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>一页代码（俺贴心的给你们设置了白名单机制，在哪儿设置自己找）</p>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lee.api;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.http.HttpRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.json.JSONUtil;</span><br><span class="line"><span class="keyword">import</span> io.github.biezhi.wechat.WeChatBot;</span><br><span class="line"><span class="keyword">import</span> io.github.biezhi.wechat.api.annotation.Bind;</span><br><span class="line"><span class="keyword">import</span> io.github.biezhi.wechat.api.constant.Config;</span><br><span class="line"><span class="keyword">import</span> io.github.biezhi.wechat.api.enums.MsgType;</span><br><span class="line"><span class="keyword">import</span> io.github.biezhi.wechat.api.model.WeChatMessage;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloBot</span> <span class="keyword">extends</span> <span class="title">WeChatBot</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HelloBot</span><span class="params">(Config config)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(config);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; notRec=Arrays.asList(<span class="string">&quot;老聂&quot;</span>,<span class="string">&quot;老黄&quot;</span>);</span><br><span class="line">    <span class="meta">@Bind(msgType = MsgType.TEXT)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleText</span><span class="params">(WeChatMessage message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotEmpty(message.getName())</span><br><span class="line">                &amp;&amp;!message.isGroup()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;接收到 [&quot;</span>+message.getName()+<span class="string">&quot;] 的消息: &quot;</span></span><br><span class="line">                                                  +message.getText());</span><br><span class="line">             String mSg =<span class="string">&quot;我可能有点问题,等会回复你噢&quot;</span>;</span><br><span class="line">             <span class="keyword">if</span>(!notRec.contains(message.getFromRemarkName())) &#123;</span><br><span class="line">                 <span class="keyword">try</span> &#123;</span><br><span class="line">                     mSg = getReply(message.getText());</span><br><span class="line">                 &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                     System.out.println(e.getMessage());</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">this</span>.sendMsg(message.getFromUserName(), mSg );</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">String <span class="title">getReply</span><span class="params">(String msg)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String param=<span class="string">&quot;&#123;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    \&quot;perception\&quot;: &#123;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        \&quot;inputText\&quot;: &#123;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;            \&quot;text\&quot;: \&quot;MSG\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &#125;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &#125;,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    \&quot;userInfo\&quot;: &#123;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        \&quot;apiKey\&quot;: \&quot;608df9e00ab648ac91968a20b11dba3f\&quot;,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        \&quot;userId\&quot;: \&quot;635279\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &#125;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> String body = HttpRequest.post(<span class="string">&quot;https://openapi.tuling123.com/openapi/api/v2&quot;</span>)</span><br><span class="line">                .body(JSONUtil.parse(param.replace(<span class="string">&quot;MSG&quot;</span>,msg)).toString())</span><br><span class="line">                .execute().body();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JSONUtil.parseObj(body).getByPath(<span class="string">&quot;results[0].values.text&quot;</span>).toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> HelloBot(Config.me().autoLogin(<span class="keyword">true</span>).showTerminal(<span class="keyword">true</span>)).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>PS：里面图灵接口的请求参数apiKey及userId是俺在<a href="http://www.turingapi.com/">图灵API</a> 注册获取的，有需要可自己去注册。</p><h2 id="更多翻车栗子"><a href="#更多翻车栗子" class="headerlink" title="更多翻车栗子"></a>更多翻车栗子</h2><p><a href="https://www.pianshen.com/article/96801052825/">微信自动回复 | 如何智能秒回女朋友 - 程序员大本营</a></p></li></ul><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2020/07/10/Java%E4%B8%80%E9%A1%B5%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E8%87%AA%E5%8A%A8%E5%9B%9E%E5%A4%8D/">leeblog.icu/2020/07/10/Java一页代码之实现微信自动回复/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">机器可以替代我们自动打开空调，可以替代我们洗碗拖地，甚至替代我们开车(真开车，别多想)，现在，它还可以替我们聊天，是的，它说：Yes，I do!</summary>
    
    
    
    <category term="技术" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/"/>
    
    <category term="java" scheme="leeblog.icu/categories/%E6%8A%80%E6%9C%AF/java/"/>
    
    
    <category term="java" scheme="leeblog.icu/tags/java/"/>
    
    <category term="x页代码" scheme="leeblog.icu/tags/x%E9%A1%B5%E4%BB%A3%E7%A0%81/"/>
    
    <category term="wechat" scheme="leeblog.icu/tags/wechat/"/>
    
  </entry>
  
  <entry>
    <title>寻三儿启事</title>
    <link href="leeblog.icu/2019/09/01/%E5%AF%BB%E4%B8%89%E5%84%BF%E5%90%AF%E4%BA%8B/"/>
    <id>leeblog.icu/2019/09/01/%E5%AF%BB%E4%B8%89%E5%84%BF%E5%90%AF%E4%BA%8B/</id>
    <published>2019-09-01T10:22:06.000Z</published>
    <updated>2021-05-09T02:43:34.571Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 三儿啊，我们永远不知道哪次是这辈子最后一次</p></blockquote><p>三儿，原名张自清，少白头，常擎富光最大号杯子牛饮，平日寡言少语。</p><p>三儿为什么叫三儿，我早已忘了。结识他，已有十年。我丝毫不怀疑，他是我人生的第一个导师。如此称呼，当然不止因为我在他那第一次欣赏到了毛片。</p><p>我们是初中同学，我俩家就在博宇中学后边的沙果园，隔着两条街，却从未结识，直到初中。</p><p>初中，那时青春懵懂，最幼稚，也最哲学。内向敏感，很少说话。一次突觉自己生命之无意义，思而不得，困苦的厉害。一晚，终于鼓起勇气求助于能给我答案的政治思想老师，我说，老师，人为什么活着？人类日复一日存在的终极意义在哪儿？ </p><p>她推着自行车，显得好惊讶，她想了好久，说了好多。却最终没有足以让当时的我信服的答案。现在回头看，千百年来层出不穷的哲学家们也没有答案。我绝望极了。</p><p>三儿有个和我一样严厉的医生爸爸，三儿身上总有一股雕牌肥皂的味道，很好闻。后来我才知道，他一天最少五次洗手，每次洗手都会用肥皂，他说，洗手不用雕牌的肥皂简直相当于白洗。我总肆虐的想，是不是他爸爸小时候也骗他饭前不洗手就会死掉。 </p><p>三儿比我，比我们老成多了，他在班级里拿富光最大号杯子喝水、在班里少言寡语，噢对了，他还有少白头，这一切让我觉得他是个深不可测的人物。</p><p>对，那个放学铃不断回荡的晚上我抛给政治老师的问题，没有得到满意的答案后，抛给了他。他显得一脸鄙夷，喝完了一大杯富光水。终于说，没有特么的意义，生物本能懂么？ </p><p>我自然没太懂，但对他这么直接了当的回答显得满意极了。放学时，他又淡淡的补了一句，周末来我家。</p><p>我去了，他带我去了他的秘密基地，一个离他家不远、胡同深处废弃的院子，荒草丛生，推开正屋的门，偏厅放着一台电脑。还有一个落满灰尘书架。大白天都阴森森的可怕。然后在那个周末，在那个电脑旁，我第一次目睹了什么叫生物本能。</p><p>他问我，理解了么？我说，有点儿恶心。</p><p>大概在那时我的青春期开始了。</p><p> 后来，后来啊，我发现三儿不止对毛片有见解，政治、历史同样头头是道且有着自己独特见解。在那个春夏秋冬，我带他成了新华书店的常客，他带我找遍了黑网吧。</p><p> 但是三儿从没有、也从不用当时流行的QQ。</p><p> 最后两三次，最后两三次分别时，我每次都会对他说：三儿啊，我们永远不知道哪次是这辈子最后一次。然后颤巍巍掏出早已写好的纸条。简直泪眼婆娑的对他说，这是我QQ号，那天你想开了有了QQ，就加我。</p><p> 后来随着老城区改造，再也杳无音讯。</p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2019/09/01/%E5%AF%BB%E4%B8%89%E5%84%BF%E5%90%AF%E4%BA%8B/">leeblog.icu/2019/09/01/寻三儿启事/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">最后两三次，最后两三次分别时，我每次都会对他说：三儿啊，我们永远不知道哪次是这辈子最后一次。然后颤巍巍掏出早已写好的纸条...</summary>
    
    
    
    <category term="随笔" scheme="leeblog.icu/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="随笔" scheme="leeblog.icu/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>再见仓老师</title>
    <link href="leeblog.icu/2019/04/06/%E5%86%8D%E8%A7%81%E4%BB%93%E8%80%81%E5%B8%88/"/>
    <id>leeblog.icu/2019/04/06/%E5%86%8D%E8%A7%81%E4%BB%93%E8%80%81%E5%B8%88/</id>
    <published>2019-04-05T16:44:25.000Z</published>
    <updated>2020-10-07T07:30:28.815Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>等待即是希望，即是一切美好的开始</p></blockquote><p>北京今天的空气达到了PM 10 367重污染，窗外的山没了，夕阳没了，取而代之的是厚重而浑浊的霾。我转身看了看桌上胡乱摆着的闲书，庆幸自己没出去。</p><p>看书、订餐、摆弄好长时间没碰的画架、午休、发呆、看电影、然后打两把游戏，一切都是那么稀松平常，静谧平淡，毫无意外，就像那两把游戏，都毫无意外的输掉。</p><p>大概晚上九点，照常起身去储藏室喂仓鼠。然后看到，仓老师这次很乖，他趴在那，一动不动，他走了。我不太清楚自己在那一刻是怎样一种情绪状态，我好像再次看到了幼时趴在哪里一动不动的狗狗，好像又看到了安静的像是睡去的人。死亡，就这样立体直观的呈现在眼前。我蹲坐在那儿，一片茫然，不知所措。</p><p>似乎心里一直都在为这一天的到来准备着，从他来到我的生活里。这次，他真的走了。之前工作比较忙的时候，忙到需要直接就近睡酒店的时候，我想，我要回家，因为他在等我，我家里有牵挂，像是那些有家室的同事一样。这次，真的没了。</p><p>于是踉踉跄跄的滚回了卧室，坐在那儿缓了好一会儿。</p><p>沉默，沉默，一切寂静的不像话。</p><p>没哭。</p><p>我打定主意，要为他买朵花，与他一起葬进土里。不是因为他多么喜欢花，只是自私的为自己，为自己寻求一点安慰。</p><p>生命，自从诞生便开始死亡的过程，一分一秒，直至尽头。</p><p>我便顿时明白了，等待戈多，戈多即死神。</p><p>后来又觉得太直白而残酷，附上另一句：等待即是希望，即是一切美好的开始。以哄骗世人，同时忽悠自己走下去。我们别无选择。</p><p>把储藏室打扫干净。给他买的菜没喂完，就扔了。为他新买的小房子还没到，就退了。好像他从未来过，除了那朵花在微风中摇曳，直至凋零、枯去，化作春泥。</p><p>同日，我妈电话来兴奋的告知我：家里的狗子生了，三只小狗商量好似的都是黑黝黝的，尚未睁眼，很是可爱。唠叨着：再过几天定是满院子撒欢儿了。</p><p>一切美好的开始。  </p><p align="right" >一九年四月六日</p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2019/04/06/%E5%86%8D%E8%A7%81%E4%BB%93%E8%80%81%E5%B8%88/">leeblog.icu/2019/04/06/再见仓老师/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">仓老师这次很乖，他趴在那，一动不动，他走了...死亡，就这样立体直观的呈现在眼前。我蹲坐在那儿，一片茫然，不知所措。</summary>
    
    
    
    <category term="随笔" scheme="leeblog.icu/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="随笔" scheme="leeblog.icu/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Jack</title>
    <link href="leeblog.icu/2019/03/10/Jack/"/>
    <id>leeblog.icu/2019/03/10/Jack/</id>
    <published>2019-03-10T10:39:20.000Z</published>
    <updated>2021-05-09T02:43:34.561Z</updated>
    
    <content type="html"><![CDATA[<p>Jack洗完衣服，照常换了大裤衩、趿拉着拖鞋出门了，找了个有信号的地方，点着烟。他看着列表里的Lucy，琢磨着发点啥，可他琢磨来琢磨去，没想出什么，Lucy反而在这时一条消息提示，“xxxxxxx，xxx”，<br>Jack盯着这条信息，有些不太相信。他愣了半天，又狠狠的抽了一口，他想发个表情，大概可以掩饰一下自己的尴尬与不知所措，却没有得逞，“对方拒收了您的消息”。Jack看着这个夜晚，有颗很亮很亮的星，只有一颗，眨呀眨的。</p><p>jack抽完第二棵宏图便回去了，家里的烟他有些抽不惯了，没有的时候却想。摸摸裤兜的钥匙，开门。jack坐在床角，无数次他都一个人这么静静的坐着，好像什么都没想过，好像想了好多。竟有些享受这种滋味呢，jack想着。不一会儿，便躺下睡了。</p><p>这是Jack睡的最早的一个晚上，也是睡的最长的一个觉，没人不知道那天梦里他去了哪。没人关心这一切。</p><p align="right" >摘自某刊</p><p><strong>本文作者</strong>：Lee<br/><strong>本文地址</strong>： <a href="leeblog.icu/2019/03/10/Jack/">leeblog.icu/2019/03/10/Jack/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC 4.0 BY-NC-SA</a> 许可协议。转载请注明出处！</p>]]></content>
    
    
    <summary type="html">这是Jack睡的最早的一个晚上，也是睡的最长的一个觉，没人不知道那天梦里他去了哪。没人关心这一切。</summary>
    
    
    
    <category term="随笔" scheme="leeblog.icu/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="随笔" scheme="leeblog.icu/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
</feed>
